<html>
    <head>
        <title>Test odometerservice</title>
        <script type="text/javascript">

        function sideload(form) {

            var formData = new FormData();
            formData.append('xmeml', document.getElementById('xmeml').files[0]);
            var oOutput = document.getElementById('content');
            var oStatusView = document.getElementById('status');

            var oReq = new XMLHttpRequest();
            oReq.open("POST", "/analyze", true);
            oReq.onload = function(oEvent) {
                //console.log(oEvent);
                //console.log(oReq);
                if (oReq.status == 201) {
                    //:woOutput.innerHTML = "Uploaded!";
                    oOutput.innerText = oReq.responseText;
                    var oStatus = JSON.parse(oReq.responseText);
                    oStatusView.src = oStatus.statusUrl;

                } else {
                    oOutput.innerHTML = "Error " + oReq.status + " occurred when trying to upload your file.<br \/>";
                }
            };

            oReq.send(formData);

        }
        </script>
    </head>
    <body>
        <form onsubmit="return false" enctype="multipart/form-data">
            <input type="file" value="xmeml" id="xmeml">
            <button onclick="sideload(this)">Analyze it!</button>
        </form>
        <textarea id="content" style="width: 100%; height: 5em; border: 1px solid black;">
            Reply goes here
        </textarea>
        <iframe id="status" style="width: 100%; height: 20em; border: 3px double black;"></iframe>
    </body>
</html>