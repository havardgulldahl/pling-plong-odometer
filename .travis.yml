sudo: true
# we dont want to use the container based setup because fuse isnt available there, so we set "sudo: true"

language: python


#osx version matrix per september 2016
#<osx_tag>                <xcode version>   <osx version>
#osx_image: xcode8	      Xcode 8beta6	    OS X 10.11
#osx_image: xcode7.3	    Xcode 7.3.1	      OS X 10.11
#osx_image: xcode7.2	    Xcode 7.2.1	      OS X 10.11
#osx_image: xcode7.1	    Xcode 7.1.1 GM	  OS X 10.10
#osx_image: xcode7	      Xcode	            OS X 10.10
#osx_image: xcode6.4	    Xcode	            OS X 10.10
#osx_image: beta-xcode6.3	Xcode	            OS X 10.10
#osx_image: beta-xcode6.2	Xcode	            OS X 10.9
#osx_image: beta-xcode6.1 Default	Xcode	    OS X 10.9

matrix:
  include:
    #- os: linux
    #  dist: trusty
    #  sudo: required
    #  python: 2.7

    - os: osx
      osx_image: xcode7.2
      language: generic
      env: OSX=OSX10.11
    - os: osx
      osx_image: xcode6.4
      language: generic
      env: OSX=OSX10.10
    - os: osx
      osx_image: beta-xcode6.2
      language: generic
      env: OSX=OSX10.9


# dont test feature branches
branches:
  only:
    - master

init:
  - echo "Booting Mac ${OSX} "

# install dependencies
before_install:
  - if [ "$TRAVIS_OS_NAME" = "linux" ]; then sudo apt-get update; fi
  - if [ "$TRAVIS_OS_NAME" = "osx" ]; then brew update || brew update; fi
  - if [ "$TRAVIS_OS_NAME" = "osx" ]; then brew install python; fi
  - pip install py2app

# install our program
install:
  - pip install -r requirements.txt
  - pip install .
  - ls

script:
  # run tests
  #- PYTHONPATH=$PYTHONPATH:./src py.test tests/
  # create package
  - if [ "$TRAVIS_OS_NAME" = "osx" ]; then ./build-mac.sh; fi
